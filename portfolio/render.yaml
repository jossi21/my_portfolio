# render.yaml
# Place this file in: Portfolio/portfolio/render.yaml

version: "1"
services:
  - type: web
    name: backend # Change to your preferred name
    env: node
    region: oregon # Pick: oregon, frankfurt, singapore, ohio
    plan: free

    # CRITICAL: This points to your backend folder
    rootDirectory: ./backend

    # Build commands (run inside ./backend)
    buildCommand: |
      npm install
      npx prisma generate
      npx prisma migrate deploy

    # Start command: runs "node app.js"
    startCommand: npm start

    # Health check - you'll need to add this route
    healthCheckPath: /api/health
    healthCheckTimeout: 30

    autoDeploy: true

    # Environment variables
    envVars:
      - key: NODE_ENV
        value: production
      - key: PORT
        value: 2127 # Render sets PORT automatically, but just in case

databases:
  - name: portfolio-db
    databaseName: portfoliodb
    user: portfolioadmin
    region: oregon
    plan: free
    ipAllowList: [] # Allow all IPs
